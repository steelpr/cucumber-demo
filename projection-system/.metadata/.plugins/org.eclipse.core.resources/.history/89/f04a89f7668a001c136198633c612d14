package projections.register.service;

import java.util.ArrayList;
import java.util.List;

import projections.models.User;

public class RegisterService {
	private static List<User> usersDB = new ArrayList<>();

	public static String register(String username, String firstPassword, String secondPassword) {

		intDb();

		if (null == firstPassword || firstPassword.isBlank()) {
			return "Ð’ÑŠÐ²ÐµÐ´ÐµÑ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»Ð°!";
		}

		if (!firstPassword.equals(secondPassword)) {
			return "Ð’ÑŠÐ²ÐµÐ´ÐµÑ‚Ðµ ÐµÐ´Ð½Ð°ÐºÐ²Ð¸ Ð¿Ð°Ñ€Ð¾Ð»Ð¸!";
		}

		if (username == null || username.isBlank()) {
			return "Ð’ÑŠÐ²ÐµÐ´ÐµÑ‚Ðµ Ð¸Ð¼Ðµ!";
		}

		boolean isUsernameExists = usersDB.stream().anyMatch(u -> u.getUsername().equals(username));
		if (isUsernameExists) {
			return "ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»Ñ?ÐºÐ¾Ñ‚Ð¾ Ð¸Ð¼Ðµ Ðµ Ð·Ð°ÐµÑ‚Ð¾!";
		}

		final User newUser = new User(username, firstPassword);
		usersDB.add(newUser);
		return "Ð£Ñ?Ð¿ÐµÑˆÐ½Ð° Ñ€ÐµÐ³Ð¸Ñ?Ñ‚Ñ€Ð°Ñ†Ð¸Ñ?!";
	}

	private static void intDb() {
		usersDB.clear();
		usersDB.add(new User("ÐŸÐµÑˆÐ¾", "ÐŸÐµÑˆÐ¾123"));
	}

}
